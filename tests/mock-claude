#!/bin/bash
# Mock claude command for smoke testing
# Writes a marker file to prove it was called
# Exit code controlled by MOCK_CLAUDE_EXIT_CODE (default: 0)

MARKER_DIR="${SMOKE_TEST_MARKER_DIR:-/tmp}"
MARKER_FILE="${MARKER_DIR}/claude-was-called"
EXIT_CODE="${MOCK_CLAUDE_EXIT_CODE:-0}"

# Log the arguments we received
echo "mock-claude called with args: $*" >> "${MARKER_FILE}"
echo "timestamp: $(date -u +%Y-%m-%dT%H:%M:%SZ)" >> "${MARKER_FILE}"
echo "exit_code: ${EXIT_CODE}" >> "${MARKER_FILE}"

exit "${EXIT_CODE}"
